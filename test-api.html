<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Test Gemini API Models</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
    .model-result { padding: 10px; margin: 5px 0; border-radius: 5px; }
    .success { background: #d4edda; border: 1px solid #28a745; }
    .error { background: #f8d7da; border: 1px solid #dc3545; }
    .testing { background: #fff3cd; border: 1px solid #ffc107; }
    input { width: 100%; padding: 10px; margin: 10px 0; }
    button { padding: 10px 20px; cursor: pointer; }
    pre { background: #f5f5f5; padding: 10px; overflow: auto; font-size: 12px; }
  </style>
</head>
<body>
  <h1>üîç Test Gemini API Models</h1>
  
  <div>
    <label><strong>API Key:</strong></label>
    <input type="password" id="apiKey" placeholder="Nh·∫≠p API key c·ªßa b·∫°n">
  </div>
  
  <button onclick="testAllModels()">Test T·∫•t c·∫£ Models</button>
  <button onclick="testSingleModel('gemini-3-pro-preview')">Test Gemini 3 Pro Preview</button>
  <button onclick="testSingleModel('gemini-2.5-pro')">Test Gemini 2.5 Pro</button>
  
  <div id="results" style="margin-top: 20px;"></div>
  
  <script>
    const models = [
      'gemini-2.5-flash-lite',
      'gemini-2.5-flash',
      'gemini-2.5-pro',
      'gemini-flash-latest',
      'gemini-2.0-flash-lite',
      'gemini-2.0-flash',
      'gemini-exp-1206',
      'gemini-3-pro-preview',
    ];
    
    async function testModel(apiKey, model) {
      const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;
      
      // Gemini 3 models require temperature=1.0
      const isGemini3 = model.includes('gemini-3');
      const temperature = isGemini3 ? 1.0 : 0.2;
      
      const requestBody = {
        contents: [{
          parts: [{ text: 'Say "Hello" in Vietnamese' }]
        }],
        generationConfig: {
          temperature: temperature,
          maxOutputTokens: 100,
        }
      };
      
      try {
        const response = await fetch(url, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(requestBody)
        });
        
        const data = await response.json();
        
        if (!response.ok) {
          return {
            success: false,
            status: response.status,
            error: data.error?.message || JSON.stringify(data),
            errorCode: data.error?.status || 'UNKNOWN'
          };
        }
        
        const text = data.candidates?.[0]?.content?.parts?.[0]?.text || 'No response';
        return { success: true, response: text };
        
      } catch (error) {
        return { success: false, error: error.message, errorCode: 'NETWORK_ERROR' };
      }
    }
    
    async function testSingleModel(model) {
      const apiKey = document.getElementById('apiKey').value.trim();
      if (!apiKey) {
        alert('Vui l√≤ng nh·∫≠p API key!');
        return;
      }
      
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = `<div class="model-result testing">‚è≥ ƒêang test ${model}...</div>`;
      
      const result = await testModel(apiKey, model);
      
      if (result.success) {
        resultsDiv.innerHTML = `
          <div class="model-result success">
            <strong>‚úì ${model}</strong>
            <pre>${result.response}</pre>
          </div>`;
      } else {
        resultsDiv.innerHTML = `
          <div class="model-result error">
            <strong>‚úó ${model}</strong> (${result.status || 'Error'})
            <br>Error Code: <code>${result.errorCode}</code>
            <pre>${result.error}</pre>
          </div>`;
      }
    }
    
    async function testAllModels() {
      const apiKey = document.getElementById('apiKey').value.trim();
      if (!apiKey) {
        alert('Vui l√≤ng nh·∫≠p API key!');
        return;
      }
      
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '<h3>ƒêang ki·ªÉm tra...</h3>';
      
      let html = '<h3>K·∫øt qu·∫£ ki·ªÉm tra:</h3>';
      
      for (const model of models) {
        resultsDiv.innerHTML = html + `<div class="model-result testing">‚è≥ ƒêang test ${model}...</div>`;
        
        const result = await testModel(apiKey, model);
        
        if (result.success) {
          html += `
            <div class="model-result success">
              <strong>‚úì ${model}</strong>
              <pre>${result.response}</pre>
            </div>`;
        } else {
          html += `
            <div class="model-result error">
              <strong>‚úó ${model}</strong> (HTTP ${result.status || 'Error'})
              <br>Error Code: <code>${result.errorCode}</code>
              <pre>${result.error}</pre>
            </div>`;
        }
        
        resultsDiv.innerHTML = html;
      }
      
      // Summary
      const successful = (html.match(/model-result success/g) || []).length;
      html = `<h3>K·∫øt qu·∫£: ${successful}/${models.length} models ho·∫°t ƒë·ªông</h3>` + html.replace('<h3>K·∫øt qu·∫£ ki·ªÉm tra:</h3>', '');
      resultsDiv.innerHTML = html;
    }
  </script>
</body>
</html>
